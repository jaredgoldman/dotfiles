# ~/.bashrc

# Keychain
eval $(keychain --eval --quiet id_ed25519_gh id_ed25519_osf)

# If not running interactively, don't do anything
[[ $- != *i* ]] && return
PS1='[\u@\h \W]\$ '


# -- Aliases -- #
alias ls='ls --color=auto'
alias grep='grep --color=auto'

# Virtual env
alias pyenv="source env/bin/activate"

# NVIM
alias vim="nvim"

# Networking
alias whichwanip="dig +short myip.opendns.com @resolver1.opendns.com"

# Brightness
alias brightness="xrandr --output eDP1 --brightness"

# -- Functions-- #

## Spanish translations
function ts() {
    input=$1
    trans es:en "$input"
}

function te() {
    input=$1
    trans en:es "$input"
}

## Delete old git branches
function delete_old_branches() {
    local branch last_commit
    local months_ago=${1:-3} # Default to 3 months if no argument is provided.

    git for-each-ref --sort=-committerdate refs/heads/ --format='%(refname:short) %(committerdate:iso8601)' | while read branch last_commit; do
        if [[ $(date -d "$last_commit" +%s) -lt $(date -d "$months_ago months ago" +%s) ]]; then
            echo "Deleting old branch $branch last committed on $last_commit"
            git branch -D "$branch"
        fi
    done
}

## Simple git commit shorcut
function gc () {
    git add .
    git commit -m "$1"
    git push
}

## Shortcut for pulling specific files from development
function gcod () {
    ## check if development branch exists
    ## if not use develop
    git fetch origin
    git checkout origin/development "$1"
}

function generate_ssh_key() {
    # Prompt for a custom string to append to the filename
    read -p "Enter a custom string to append to the key filename: " custom_string

    # Define the key file names
    private_key="~/.ssh/id_ed25519_$custom_string"
    public_key="~/.ssh/id_ed25519_$custom_string.pub"

    # Generate the ED25519 key pair
    ssh-keygen -t ed25519 -f "$private_key" -N ""

    # Print the public key
    echo "Public Key:"
    cat "$public_key"
}

## Convert all HEIC files in a dir to PNG
function heictopng() {
  for file in *.heic;
    do heif-convert "$file" "${file%.heic}.png";
  done
}

# optimize all pngs into a single file
function optpngs() {
  # prmpt user before executing
  read -p "Are you sure you want to optimize these images? [y/n]" -n 1 -r
    for file in *.png; do
        optipng -o7 "$file"
    done
}

# - PNPM && NVM -- #
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac

# -- Variables --#
export HISTSIZE=-1
export HISTFILESIZE=-1
export SAM_CLI_TELEMETRY=0
export EDITOR="nvim"
export NVM_DIR="$HOME/.nvm"
export PNPM_HOME="/home/jg/.local/share/pnpm"
export PATH="/user/sbin:$PATH"

